<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Everest By Ramy Eid - Luxury Watch Servicing</title>

    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">

    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        charcoal: '#060606',
                        lightGray: '#F3F4F6',
                        gold: '#FBBF24',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        #summary-screen {
            display: flex;
            flex-direction: column;
            min-height: 80vh;
            /* Make the container tall */
        }

        html {
            scroll-behavior: smooth;
        }

        * {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }

        *::-webkit-scrollbar {
            display: none;
            /* Safari and Chrome */
        }

        /* 2. Standalone CSS for the transition */
        /* This is needed because the transition is a custom behavior */
        /* that isn't a standard Tailwind utility. */
        .screen-container {
            /* This makes the slide animation smooth */
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .slide-to-services {
            /* This moves the container 50% to the left, revealing the second screen */
            transform: translateX(-50%);
        }

        /* --- NEW CSS FOR THE DYNAMIC UNDERLINE --- */
        #service-title {
            position: relative;
            /* This allows us to position the underline relative to the title. */
            display: inline-block;
            /* This makes the title's container only as wide as the text itself. */
            padding-bottom: 0.5rem;
            /* Adds space below the text for the line. */
        }

        #service-title::after {
            content: '';
            /* Pseudo-elements need a 'content' property to show up. */
            position: absolute;
            /* Positions the underline relative to the #service-title. */
            bottom: 0;
            /* Places the line at the very bottom of the padded space. */
            left: 50%;
            /* Centers the starting point of the line. */
            transform: translateX(-50%);
            /* Pulls the line back to the left by half its own width, perfectly centering it. */
            width: 120%;
            /* Makes the underline 20% wider than the text. */
            height: 2px;
            /* Sets the thickness of the line. */
            background-color: #FBBF24;
            /* Sets the color to your 'gold' theme color. */
            border-radius: 1px;
            /* (Optional) Makes the ends of the line slightly rounded. */
        }

        /* --- SCROLL INDICATOR STYLES --- */
        #scroll-indicator {
            /* Positioning */
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;

            /* Appearance */
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;

            /* Animation and Transition */
            animation: bounce 2s infinite;
            transition: opacity 0.5s, visibility 0.5s;
        }

        /* A class to hide the indicator smoothly */
        #scroll-indicator.hidden {
            opacity: 0;
            visibility: hidden;
        }

        /* The bouncing animation */
        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateX(-50%) translateY(0);
            }

            40% {
                transform: translateX(-50%) translateY(-10px);
            }

            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        #video-overlay {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        #video-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .fade-in {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        #summary-screen {

            margin-bottom: 1rem;

        }

        #summary-screen {
            display: none;
            /* This completely hides it by default */
        }

        #summary-screen.active {
            display: flex;
            opacity: 1;
        }
    </style>
</head>

<body class="bg-charcoal text-lightGray font-sans antialiased">

    <div id="scroll-indicator">
        <span>Scroll for more</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16.59 8.59003L12 13.17L7.41 8.59003L6 10L12 16L18 10L16.59 8.59003Z" fill="currentColor" />
        </svg>
    </div>


    <div id="app-container" class="min-h-screen flex flex-col items-center p-4 sm:p-6">

        <header class="w-full max-w-md mb-8">
            <img src="./img/everestnew2.png" alt="everest logo" class="pointer-events-none">
        </header>

        <main class="w-full max-w-md flex-grow flex flex-col">
            <div id="service-counter-viewport" class="max-w-md mx-auto relative overflow-x-hidden">
                <div id="screen-slider" class="w-[200%] flex transition-transform duration-500 ease-in-out">
                    <section id="brand-selection" class="w-1/2 px-2">
                        <h2 class="text-xl font-semibold mb-6 text-center">Select Your Timepiece Brand</h2>
                        <div class="w-full grid grid-cols-2 gap-4">

                            <button data-action="select-brand" data-brand="Richard Mille"
                                class="brand-btn flex  items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/richard-mille-logo2.png" alt="Richard-Mille Logo"
                                        class="object-contain max-w-[100%] max-h-[170%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>

                            <button data-action="select-brand" data-brand="AP"
                                class="brand-btn flex items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/audemars-piguet2.png" alt="Audemars Piguet Logo"
                                        class="object-contain max-w-[120%] max-h-[170%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>

                            <button data-action="select-brand" data-brand="Patek Philippe"
                                class="brand-btn flex items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/patek-philippe.png" alt="Patek Philippe Logo"
                                        class="object-contain max-w-[120%] max-h-[170%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>

                            <button data-action="select-brand" data-brand="Rolex"
                                class="brand-btn flex items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/rolex-logo.png" alt="Rolex Logo"
                                        class="object-contain max-w-[120%] max-h-[120%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>



                            <button data-action="select-brand" data-brand="Cartier"
                                class="brand-btn flex  items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/cartier-logo.png" alt="Cartier Logo"
                                        class="object-contain max-w-[90%] max-h-[100%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>




                            <button data-action="select-brand" data-brand="Omega"
                                class="brand-btn flex  items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/omega2.png" alt="Omega Logo"
                                        class="object-contain max-w-[140%] max-h-[140%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>

                            <button data-action="select-brand" data-brand="Hublot"
                                class="brand-btn flex  items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md transition-colors duration-300 hover:bg-gold hover:text-charcoal touch-pan-y">
                                <div class="h-20 flex items-center justify-center">
                                    <img src="./logos/hublot-logo.png" alt="Hublot Logo"
                                        class="object-contain max-w-[80%] max-h-[100%] object-contain filter invert pointer-events-none">
                                </div>

                            </button>





                        </div>
                    </section>










                    <section id="service-selection-screen" class="w-1/2 px-2">
                        <header class="text-center my-8 relative">
                            <button id="back-btn"
                                class="absolute left-0 top-20 text-slate-400 hover:text-white transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 19l-7-7 7-7" />
                                </svg>
                            </button>
                            <h1 id="service-title" class="text-3xl font-bold">Rolex Service</h1>
                            <p class="text-lg text-slate-400 mt-2">Select a Service</p>
                        </header>

                        <div class="space-y-4">
                            <legend class="sr-only">Service Options</legend>



                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="Full Routine Service" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Full Routine Service</span>
                                <span class="block mt-1 text-sm text-slate-400">Complete maintenence, cleaning, and
                                    regulation.</span>
                            </div>



                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="repair" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Non-Working Watch Repair</span>
                                <span class="block mt-1 text-sm text-slate-400">Restoration of the movement's
                                    functionality.</span>

                            </div>
                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="polish" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Case & Bracelet
                                    Polishing</span>
                                <span class="block mt-1 text-sm text-slate-400">Expert restoration of your
                                    timepiece's finish.</span>
                            </div>



                            <div for="service4"
                                class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="strapchange" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Strap Change</span>
                                <span class="block mt-1 text-sm text-slate-400">Replace your timepiece's strap with
                                    a new one.</span>
                            </div>



                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="batteryreplacement" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Battery Replacement</span>
                                <span class="block mt-1 text-sm text-slate-400">Battery replacement with quality in
                                    mind.</span>
                            </div>


                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="rust" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Rusted Timepiece
                                    Restoration</span>
                                <span class="block mt-1 text-sm text-slate-400">Overhauling a rusty timepiece to
                                    it's former glory.</span>
                            </div>



                            <div class="service-btn block p-4 bg-slate-900 border-2 border-slate-700 rounded-lg cursor-pointer transition-all hover:border-amber-400"
                                data-service="waterproof" role="button" tabindex="0">
                                <span class="block text-lg font-semibold text-white">Water proof restoration</span>
                                <span class="block mt-1 text-sm text-slate-400">Includes pressure testing and seal
                                    replacement.</span>
                            </div>
                        </div>
                </div>
                </section>
            </div>
            <section id="gallery-screen" class="hidden px-2 flex flex-col">
                <header class="text-center my-8 relative">
                    <button id="back-btn-gallery" class="absolute left-0 top-1/2 -translate-y-1/2 text-slate-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 id="gallery-title" class="text-3xl font-bold">Strap Gallery</h1>
                </header>

                <div id="material-tabs-container" class="flex space-x-4 overflow-x-auto pb-4 mb-4">
                </div>

                <div id="strap-grid-container" class="w-full grid grid-cols-3 gap-4">
                </div>
            </section>





            <section id="summary-screen" class="hidden w-full max-w-md px-2 flex-col">
                <header class="text-center my-8 relative">
                    <button id="back-btn-summary"
                        class="absolute left-0 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="text-3xl font-bold">Service Summary</h1>
                </header>

                <div id="summary-details"></div>
                <ul id="service-checklist" class="space-y-2 text-slate-400">
                </ul>
                <div id="open-video-btn"></div>

                <div id="video-overlay"
                    class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
                    <div id="video-container" class="bg-charcoal p-4 rounded-lg relative w-11/12 max-w-2xl">
                        <button id="close-video-btn"
                            class="absolute -top-3 -right-3 text-white bg-red-500 rounded-full h-8 w-8 flex items-center justify-center font-bold">
                            &times;
                        </button>

                        <div id="video-embed-spot"></div>
                    </div>
                </div>

            </section>
    </div>
    </main>
    </div>
    <script>
        //restores scrollpoistion without caching interfering
        history.scrollRestoration = 'manual';
        //tracks the state of lines being printed wether to wait or not
        let currentAnimationId = 0;
        // Select the elements we need to interact with
        const screenSlider = document.getElementById('screen-slider');
        const brandButtons = document.querySelectorAll('[data-action="select-brand"]');
        const backButton = document.getElementById('back-btn');
        const serviceTitle = document.getElementById('service-title');
        // --- NEW: Set the exact number of pixels to scroll down from the top ---
        const scrollTopPixels = 350; // Adjust this value as needed

        //strap selector
        const sliderViewport = document.getElementById('service-counter-viewport');
        let selectedBrand = ''; // Stores the chosen brand

        // Selectors for the new gallery screen
        const galleryScreen = document.getElementById('gallery-screen');
        const galleryBackBtn = document.getElementById('back-btn-gallery');
        let allStrapsData = []; // To cache all strap data from the database

        // --- NEW SUMMARY SCREEN LOGIC ---
        const summaryHeader = document.getElementById('summary-header');
        const summaryScreen = document.getElementById('summary-screen');
        const summaryDetails = document.getElementById('summary-details');
        const backBtnSummary = document.getElementById('back-btn-summary');

        //video modal button
        const openVideoBtn = document.getElementById('open-video-btn');
        const closeVideoBtn = document.getElementById('close-video-btn');
        const videoOverlay = document.getElementById('video-overlay');
        const videoEmbedSpot = document.getElementById('video-embed-spot');

        // Add this new constant at the top of your script
        const whatsappNumber = "201000066867"; // <-- REPLACE WITH YOUR ACTUAL WHATSAPP NUMBER


        // This object holds the Instagram embed codes for each brand.
        const brandVideos = {
            'Rolex': './videos/Rolexpolish.mp4',
            'AP': './videos/ap-service.mp4',
            'Patek Philippe': './videos/patek-philippe-service.mp4',
            'Richard Mille': './videos/richard-mille-service.mp4',
            'Cartier': './videos/cartier-service.mp4',
            'Omega': './videos/omega-service.mp4',
            'Hublot': './videos/hublot-service.mp4',
            // A fallback video in case a brand doesn't have a specific one
            'Default': './videos/default-service.mp4'
        };

        // Add this new content object at the top of your <script>
        const serviceContent = {
            'Full Routine Service': {
                description: 'a Full Routine Service',
                checklistTitle: 'Which includes the following steps:',
                steps: [
                    "Deep Clean the Parts",
                    "Apply lubrication",
                    "Adjust for Perfect Timing"
                ]
            },
            'repair': { // This key matches the data-service="repair" on your button
                description: 'a Non-Working Movement Repair',
                checklistTitle: 'Our diagnostic and repair process involves:',
                steps: [
                    "Replace Broken Parts",
                    "Fine-Tune The Movement",
                    "Check Power and Accuracy"
                ]
            },
            'rust': { // This key matches the data-service="rust"
                description: 'a Rusted Timepiece Restoration',
                checklistTitle: 'The restoration journey includes:',
                steps: [
                    "Remove All Rust",
                    "Replace Damaged Parts",
                    "Polish The Case",
                    "Reassemble and Seal"
                ]

            },
            // Inside your serviceContent object, add a comma after the 'rust' entry and then add this new block:

            'polish': { // Key matches data-service="polish"
                description: 'a Case & Bracelet Polish',
                checklistTitle: 'Our professional polishing service includes:',
                steps: [
                    "First, We Clean It",
                    "Polish for a Mirror Shine",
                    "Create a Brushed Look",
                    "Final Deep Clean"
                ]
            }
            // You can add more services here, like 'polish', 'waterproof', etc.
        };


        // A helper function to create a precise delay
        const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

        // Add a click listener to every brand button
        brandButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Get the brand name from the button's 'data-brand' attribute
                const brandName = button.dataset.brand;
                selectedBrand = brandName; // Store the brand for later use
                // Update the title text content dynamically
                serviceTitle.textContent = `${brandName} Service`;
                // When a button is clicked, add the class to trigger the slide
                screenSlider.classList.add('slide-to-services');
                // --- NEW CODE FOR AUTO-SCROLLING ---
                // Wait for the slide animation (500ms) to finish, then scroll
                setTimeout(() => {
                    window.scrollTo({
                        top: scrollTopPixels,
                        behavior: 'smooth'
                    });
                }, 200); // The delay in milliseconds
            });
        });

        async function runSummaryAnimation(serviceType) {
            // Give this animation run a unique ID
            const thisAnimationId = ++currentAnimationId;
            // 1. Create the pre-filled message using the selected brand and service
            const message = `I would like to request a ${serviceContent[serviceType].description}\nfor my ${selectedBrand} watch.`;

            // 2. URL-encode the message to make it safe for a link
            const encodedMessage = encodeURIComponent(message);

            // 3. Build the final WhatsApp URL
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

            // 1. Get the custom content for the selected service
            const content = serviceContent[serviceType];

            // Safety check: if no content is defined for this service, do nothing.
            if (!content) {
                console.error("No summary content defined for service:", serviceType);
                // Fallback to a simple alert
                alert(`Service request for "${serviceType}" submitted for ${selectedBrand}!`);
                return;
            }

            // 2. Get elements and clear them
            const summaryDetails = document.getElementById('summary-details');
            const checklist = document.getElementById('service-checklist');
            const actionButtonsContainer = document.getElementById('open-video-btn'); // This is the container for your buttons

            summaryDetails.innerHTML = '';
            checklist.innerHTML = '';
            actionButtonsContainer.innerHTML = '';

            // 3. Define the content using the dynamic object
            const line1HTML = `<span class="font-semibold text-slate-300">You have a </span> <span class="text-gold"><strong>${selectedBrand}</strong></span><span class="font-semibold text-slate-300">.</span>`;
            const line2HTML = `<span class="font-semibold text-slate-300">It needs </span> <span class="text-gold"><strong>${content.description}</strong></span> done.</span>`;
            const line3HTML = `<span class="font-semibold text-slate-300">${content.checklistTitle}</span>`;
            const serviceSteps = content.steps; // Use the steps from our object
            const buttonsHTML = `
    <div class="flex items-center gap-4 mt-8 w-full">
        <button id="open-video-btn-actual" class="bg-blue-500 text-white font-bold py-3 px-4 rounded-lg w-1/2 hover:bg-blue-600 transition-colors text-sm text-center">
            ▶️ Video Example
        </button>
        <a href="${whatsappUrl}" target="_blank" class="bg-green-800 text-white font-bold py-3 px-4 rounded-lg w-1/2 hover:bg-green-600 transition-colors text-sm flex items-center justify-center gap-2">
    <img src="./img/whatsapp_icon.png" alt="WhatsApp Icon" class="h-5 w-5">
    <span>Request Service</span>
</a>
    </div>
`;
            // --- Animation Sequence (This part remains mostly the same) ---
            // Animate Line 1
            const p1 = document.createElement('p');
            p1.className = 'text-lg fade-in';
            p1.innerHTML = line1HTML;
            summaryDetails.appendChild(p1);
            await sleep(50);
            p1.style.opacity = 1;
            await sleep(500);
            //Check if we should continue
            if (thisAnimationId !== currentAnimationId) return;

            // Animate Line 2
            const p2 = document.createElement('p');
            p2.className = 'text-lg mt-2 fade-in';
            p2.innerHTML = line2HTML;
            summaryDetails.appendChild(p2);
            await sleep(50);
            p2.style.opacity = 1;
            await sleep(500);
            //Check if we should continue
            if (thisAnimationId !== currentAnimationId) return;

            // Animate Line 3
            const p3 = document.createElement('p');
            p3.className = 'text-lg mt-2 fade-in';
            p3.innerHTML = line3HTML;
            summaryDetails.appendChild(p3);
            await sleep(50);
            p3.style.opacity = 1;
            await sleep(500);
            //Check if we should continue
            if (thisAnimationId !== currentAnimationId) return;

            // Animate Checklist
            for (const step of serviceSteps) {
                //Check if we should continue
                if (thisAnimationId !== currentAnimationId) return;
                const li = document.createElement('li');
                li.className = 'flex items-center fade-in';
                li.innerHTML = `<svg class="h-5 w-5 text-green-400 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg><span>${step}</span>`;
                checklist.appendChild(li);
                await sleep(50);
                li.style.opacity = 1;
                await sleep(500);
            }
            //Check if we should continue
            if (thisAnimationId !== currentAnimationId) return;
            // Animate the buttons in
            actionButtonsContainer.innerHTML = buttonsHTML; // Assuming you have your buttonsHTML defined
            actionButtonsContainer.className = 'fade-in';
            await sleep(50);
            actionButtonsContainer.style.opacity = 1;
            await sleep(1000);
        }

        // Add a click listener to the back button
        backButton.addEventListener('click', () => {
            // When the back button is clicked, remove the class to slide back
            screenSlider.classList.remove('slide-to-services');
        });
        // --------- Logic for direct service buttons -----------
        const serviceButtons = document.querySelectorAll('.service-btn');

        serviceButtons.forEach(button => {
            button.addEventListener('click', async () => {
                const serviceType = button.dataset.service;
                const summaryServices = ['Full Routine Service', 'repair', 'rust', 'polish']; // Add any service that should have a summary screen to this list
                if (serviceType === 'strapchange') {
                    // Hide the main services slider and show the gallery screen
                    sliderViewport.classList.add('hidden');
                    galleryScreen.classList.remove('hidden');
                    galleryScreen.classList.add('flex'); // Make sure it's visible as a flex container

                    // Scroll to the top to see the gallery header
                    window.scrollTo({ top: 0, behavior: 'smooth' });

                    // Fetch data and build the gallery
                    initializeGallery();
                } else if (summaryServices.includes(serviceType)) { // Is the service on the list?
                    // If YES, run the summary logic (only written once!)
                    // Hide the first two screens  
                    sliderViewport.classList.add('hidden');
                    // 2. Show the summary screen
                    summaryScreen.classList.add('active'); // Shows the screen
                    summaryScreen.classList.remove('hidden');
                    summaryScreen.classList.add('flex');
                    setTimeout(() => {
                        window.scrollTo({ top: 100, behavior: 'smooth' });
                    }, 0);
                    
                    runSummaryAnimation(serviceType);

                    //------------------- Scroll to the top to see the new screen---------------
                    // Scroll to the top to see the new screen
                    window.scrollTo({ top: scrollTopPixels, behavior: 'smooth' });
                } else {
                    // Keep the alert for all other service buttons
                    alert(`Service request for "${serviceType}" submitted for ${selectedBrand}!`);
                }

                // ADD THIS NEW EVENT LISTENER FOR THE MATERIAL BUTTONS
                // It listens for clicks on the container, then checks if a button was the target.
                document.getElementById('material-tabs-container').addEventListener('click', async (e) => {
                    // Only proceed if the clicked element was a button
                    if (e.target.tagName === 'BUTTON') {
                        const selectedMaterial = e.target.textContent;

                        // Update the UI
                        colorTitle.textContent = `${selectedMaterial} Colors`;
                        colorContainer.innerHTML = '<p class="text-slate-400">Loading...</p>';
                        materialScreen.classList.add('hidden');
                        colorScreen.classList.remove('hidden');

                        try {
                            // Fetch the specific straps that match the brand AND material
                            const respoaanse = await fetch(`http://localhost:3001/api/straps/filter?brandName=${encodeURIComponent(selectedBrand)}&material=${encodeURIComponent(selectedMaterial)}`);
                            const result = await response.json();

                            colorContainer.innerHTML = ''; // Clear loading message

                            // Create a button for each color option returned from the API
                            result.data.forEach(strap => {
                                const btn = document.createElement('button');
                                btn.textContent = strap.color;
                                btn.className = 'flex items-center justify-center p-4 aspect-[4/3] border border-gold rounded-md hover:bg-gold hover:text-charcoal';
                                colorContainer.appendChild(btn);
                            });
                        } catch (error) {
                            colorContainer.innerHTML = '<p class="text-red-400">Failed to load colors.</p>';
                            console.error('Error fetching colors:', error);
                        }
                    }
                });



            });
        });
        //scroll down for more logic
        // Wait for the document to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {

            // Select the scroll indicator element
            const scrollIndicator = document.getElementById('scroll-indicator');

            // Function to check scroll position
            function handleScroll() {
                // A buffer of 50px so it disappears slightly before the absolute bottom
                const scrollBuffer = 50;

                // Check if the user's scroll position is near the bottom
                // (Viewport Height + Scroll from Top >= Total Document Height)
                if (window.innerHeight + window.scrollY >= document.body.offsetHeight - scrollBuffer) {
                    scrollIndicator.classList.add('hidden');
                } else {
                    scrollIndicator.classList.remove('hidden');
                }
            }

            // Add an event listener to run the function on every scroll
            window.addEventListener('scroll', handleScroll);

            // Run the function once on load in case the page is already at the bottom
            handleScroll();
        });
        // --- NEW GALLERY FUNCTIONS ---

        /**
         * Fetches all strap data from the API and initializes the gallery display.
         */
        async function initializeGallery() {
            const strapGrid = document.getElementById('strap-grid-container');
            strapGrid.innerHTML = '<p class="text-center text-slate-400 col-span-3">Loading gallery...</p>';

            try {
                // Assumes your API endpoint to get all straps is '/api/straps'
                const response = await fetch(`http://localhost:3001/api/brands/${encodeURIComponent(selectedBrand)}/gallery`);
                if (!response.ok) throw new Error('Network response was not ok');

                const result = await response.json();
                // Flatten the grouped data from the server into a single list
                allStrapsData = Object.values(result.data).flat();

                setupFilterTabs(allStrapsData);
                displayStraps(allStrapsData);

            } catch (error) {
                strapGrid.innerHTML = '<p class="text-center text-red-400 col-span-3">Failed to load strap gallery.</p>';
                console.error('Error initializing gallery:', error);
            }
        }

        /**
         * Creates filter tabs based on the unique materials found in the strap data.
         * @param {Array} straps - The array of strap objects.
         */
        function setupFilterTabs(straps) {
            const tabsContainer = document.getElementById('material-tabs-container');
            tabsContainer.innerHTML = ''; // Clear any existing tabs

            const uniqueMaterials = ['All', ...new Set(straps.map(strap => strap.material))];

            uniqueMaterials.forEach(material => {
                const tab = document.createElement('button');
                tab.textContent = material;
                tab.className = 'material-tab px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors';
                if (material === 'All') {
                    tab.classList.add('bg-gold', 'text-charcoal'); // Style for the active tab
                } else {
                    tab.classList.add('bg-slate-700', 'text-lightGray', 'hover:bg-slate-600');
                }
                tab.dataset.material = material;
                tabsContainer.appendChild(tab);
            });
        }

        /**
         * Renders the strap cards into the grid.
         * @param {Array} straps - The array of strap objects to display.
         */
        function displayStraps(straps) {
            const strapGrid = document.getElementById('strap-grid-container');
            strapGrid.innerHTML = '';

            if (straps.length === 0) {
                strapGrid.innerHTML = '<p class="text-center text-slate-400 col-span-3">No straps found.</p>';
                return;
            }

            straps.forEach(strap => {
                const strapCard = document.createElement('div');
                strapCard.className = 'bg-slate-900 border border-slate-700 rounded-lg overflow-hidden flex flex-col';

                // IMPORTANT: Assumes your image URL is in 'strap.image_url' and you have a placeholder.
                const imageUrl = strap.image_url
                    ? `http://localhost:3001/images/${strap.image_url}`
                    : './img/placeholder.png'; // Use a local placeholder if no image is in the DB.

                strapCard.innerHTML = `
                    <div class="aspect-square w-full bg-cover bg-center" style="background-image: url('${imageUrl}')"></div>
                    <div class="p-3 text-center">
                        <p class="font-semibold text-sm truncate">${strap.color} ${strap.material}</p>
                        <p class="font-semibold text-sm truncate">${strap.price}EGP</p>
                    </div>
                `;
                strapGrid.appendChild(strapCard);
            });
        }

        // --- NEW EVENT LISTENERS FOR GALLERY ---

        // Listener for the material filter tabs
        document.getElementById('material-tabs-container').addEventListener('click', (e) => {
            if (e.target.classList.contains('material-tab')) {
                const selectedMaterial = e.target.dataset.material;

                // Update tab styles to show which is active
                document.querySelectorAll('.material-tab').forEach(tab => {
                    tab.classList.remove('bg-gold', 'text-charcoal');
                    tab.classList.add('bg-slate-700', 'text-lightGray');
                });
                e.target.classList.add('bg-gold', 'text-charcoal');

                // Filter and display straps
                const filteredStraps = (selectedMaterial === 'All')
                    ? allStrapsData
                    : allStrapsData.filter(strap => strap.material === selectedMaterial);

                displayStraps(filteredStraps);
            }
        });

        // Listener for the gallery's back button
        galleryBackBtn.addEventListener('click', () => {
            galleryScreen.classList.add('hidden');
            galleryScreen.classList.remove('flex');
            sliderViewport.classList.remove('hidden'); // Show the service selection screen again
            //gallery code --------------------------------------------------------------------------------
            // Scroll back down to the services section for a smooth transition back
            setTimeout(() => {
                window.scrollTo({ top: scrollTopPixels, behavior: 'smooth' });
            }, 100);
        });


        //---------------------MODAL VIDEO BUTTON LOGIC------------------------
        // When the "Open Video" button is clicked
        openVideoBtn.addEventListener('click', (event) => {
            // This 'if' statement is the crucial part.
            // It checks if the click came from the button with the ID 'open-video-btn-actual'
            if (event.target.closest('#open-video-btn-actual')) {
                const videoToPlay = brandVideos[selectedBrand];
                videoEmbedSpot.innerHTML = `
            <video 
                controls 
                autoplay 
                unmuted 
                playsinline 
                preload="metadata" 
                src="${videoToPlay}" 
                class="w-full rounded-lg max-h-[80vh]">
            </video>
        `;

                videoOverlay.classList.remove('hidden');
            }
        });

        // A function to close the overlay
        const closeOverlay = () => {
            // 1. Hide the overlay
            videoOverlay.classList.add('hidden');

            // 2. IMPORTANT: Remove the video embed code to stop it from playing in the background
            videoEmbedSpot.innerHTML = '';
        };

        // When the "Close" button is clicked
        closeVideoBtn.addEventListener('click', closeOverlay);

        // Also close the overlay if the user clicks on the dark background
        videoOverlay.addEventListener('click', (e) => {
            if (e.target === videoOverlay) { // Only closes if the click is on the background itself
                closeOverlay();
            }
        });


        //----------------summary back button---------------
        // Add functionality to the new screen's back button
        backBtnSummary.addEventListener('click', () => {
            // Hide the summary screen
            summaryScreen.classList.remove('active'); // Hides the screen

            // Show the service selection screen again
            sliderViewport.classList.remove('hidden');

            // Clear the dynamic content to reset the screen for next time
            document.getElementById('summary-details').innerHTML = '';
            document.getElementById('service-checklist').innerHTML = '';
            document.getElementById('open-video-btn').innerHTML = '';

            // IMPORTANT: Clear EVERYTHING inside the summary screen for a full reset

            // Scroll back down to the services section
            window.scrollTo({ top: scrollTopPixels, behavior: 'smooth' });
        });


    </script>
</body>

</html>